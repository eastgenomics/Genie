# Prioritize Sequence Ontology terms in order of severity, as estimated by
# Ensembl:
# https://ensembl.org/info/genome/variation/prediction/predicted_data.html
# and https://github.com/mskcc/vcf2maf/blob/main/vcf2maf.pl#L32
effect_priority = {
    "transcript_ablation": 1,
    "exon_loss_variant": 1,
    "sequence_feature + exon_loss_variant": 1,
    "feature_ablation": 1,
    "chromosome_number_variation": 1,
    "bidirectional_gene_fusion": 2,
    "duplication": 2,
    "gene_fusion": 2,
    "inversion": 2,
    "splice_donor_variant": 2,
    "splice_acceptor_variant": 2,
    "stop_gained": 3,
    "frameshift_variant": 3,
    "stop_lost": 3,
    "initiator_codon_variant+non_canonical_start_codon": 4,
    "rearranged_at_DNA_level": 4,
    "start_lost": 4,
    "initiator_codon_variant": 4,
    "disruptive_inframe_insertion": 5,
    "disruptive_inframe_deletion": 5,
    "conservative_inframe_insertion": 5,
    "conservative_inframe_deletion": 5,
    "inframe_insertion": 5,
    "inframe_deletion": 5,
    "protein_altering_variant": 5,
    "missense_variant": 6,
    "conservative_missense_variant": 6,
    "rare_amino_acid_variant": 6,
    "transcript_amplification": 7,
    "5_prime_UTR_truncation + exon_loss_variant": 7,
    "protein_protein_contact": 8,
    "3_prime_UTR_truncation + exon_loss": 8,
    "structural_interaction_variant": 8,
    "splice_branch_variant": 8,
    "splice_region_variant": 8,
    "splice_donor_5th_base_variant": 8,
    "splice_donor_region_variant": 8,
    "splice_polypyrimidine_tract_variant": 8,
    "start_retained_variant": 9,
    "stop_retained_variant": 9,
    "synonymous_variant": 9,
    "start_retained": 9,
    "incomplete_terminal_codon_variant": 10,
    "coding_sequence_variant": 11,
    "mature_miRNA_variant": 11,
    "exon_variant": 11,
    "transcript_variant": 11,
    "5_prime_UTR_variant": 12,
    "5_prime_UTR_premature_start_codon_gain_variant": 12,
    "3_prime_UTR_variant": 12,
    "non_coding_exon_variant": 13,
    "non_coding_transcript_exon_variant": 13,
    "non_coding_transcript_variant": 14,
    "nc_transcript_variant": 14,
    "intron_variant": 14,
    "intragenic_variant": 14,
    "INTRAGENIC": 14,
    "NMD_transcript_variant": 15,
    "coding_transcript_variant": 15,
    "upstream_gene_variant": 16,
    "downstream_gene_variant": 16,
    "TFBS_ablation": 17,
    "TFBS_amplification": 17,
    "TF_binding_site_variant": 17,
    "regulatory_region_ablation": 17,
    "regulatory_region_amplification": 17,
    "regulatory_region_variant": 17,
    "regulatory_region": 17,
    "miRNA": 17,
    "feature_elongation": 18,
    "feature_truncation": 18,
    "intergenic_variant": 19,
    "intergenic_region": 19,
    "sequence_feature": 19,
    "conserved_intron_variant": 19,
    "conserved_intergenic_variant": 20,
    "gene_variant": 19,
    "custom": 20,
    "": 20,
}

effect_map = {
    # Splice
    "splice_acceptor_variant": "Splice_Site",
    "splice_donor_variant": "Splice_Site",
    "transcript_ablation": "Splice_Site",
    "exon_loss_variant": "Splice_Site",
    "splice_region_variant": "Splice_Region",
    # Stop
    "stop_gained": "Nonsense_Mutation",
    "stop_lost": "Nonstop_Mutation",
    "incomplete_terminal_codon_variant": "Silent",
    "stop_retained_variant": "Silent",
    # Start/initiation
    "initiator_codon_variant": "Translation_Start_Site",
    "start_lost": "Translation_Start_Site",
    # Missense
    "missense_variant": "Missense_Mutation",
    "coding_sequence_variant": "Missense_Mutation",
    "conservative_missense_variant": "Missense_Mutation",
    "rare_amino_acid_variant": "Missense_Mutation",
    # Silent
    "synonymous_variant": "Silent",
    "NMD_transcript_variant": "Silent",
    # RNA-related
    "mature_miRNA_variant": "RNA",
    "exon_variant": "RNA",
    "non_coding_exon_variant": "RNA",
    "non_coding_transcript_exon_variant": "RNA",
    "non_coding_transcript_variant": "RNA",
    "nc_transcript_variant": "RNA",
    # UTR
    "5_prime_UTR_variant": "5'UTR",
    "5_prime_UTR_premature_start_codon_gain_variant": "5'UTR",
    "3_prime_UTR_variant": "3'UTR",
    # Intron / intergenic
    "transcript_amplification": "Intron",
    "intron_variant": "Intron",
    "INTRAGENIC": "Intron",
    "intragenic_variant": "Intron",
    "TF_binding_site_variant": "IGR",
    "regulatory_region_variant": "IGR",
    "regulatory_region": "IGR",
    "intergenic_variant": "IGR",
    "intergenic_region": "IGR",
    "upstream_gene_variant": "5'Flank",
    "downstream_gene_variant": "3'Flank",
}
